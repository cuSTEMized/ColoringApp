<!DOCTYPE html>
<html>
    <head>
	<link rel="stylesheet" type="text/css" href="css/style.css">
	<!-- <script type="text/javascript" src="cordova.js"></script> -->
	<script type="text/javascript" src="js/jquery-3.1.1.min.js"></script>
	<script type="text/javascript" src="js/svg-injector.min.js"></script>
    </head>
    <body>
	<nav id="navleft" class="left">
	    <button onclick="info()"><img src="icons/lightbulb.svg"/></button>
	    <button onclick="zoomOut()"><img src="icons/zoomout.svg"/></button>
	    <button onclick="zoomIn()"><img src="icons/zoomin.svg"/></button>
	    <!-- <button onclick="fillPalette()"><img src="icons/colors.svg"/></button> -->
	    <div id="test"></div>
	    
	    <script>
	     function zoomOut(){
		 cw = parseFloat(document.getElementById('main').getAttribute('width'))
		 document.getElementById('main').setAttribute('width', cw-10+'%')
	     }
	     function zoomIn(){
		 cw = parseFloat(document.getElementById('main').getAttribute('width'))
		 document.getElementById('main').setAttribute('width', cw+10+'%')
	     }
	    </script>
	</nav>
	<nav id="navright" class="right">
	    <div id="paletteBox">
	    </div>
	</nav>
	
	<article id="canvasmain">
	    <div align="center">
		<img class="inject-me" src="img/3Dprinter.svg">		
	    </div>
	</article>
	
    </body>

    <script type="text/javascript">
     document.addEventListener('deviceready', this.onDeviceReady, false);
     document.body.onload = function(){ onDeviceReady() };
     var color = ""; // global

     function setSize() {
	 var height = $(window).height();
	 var width = $(window).width();
	 console.log(height);
	 console.log(width);

	 $("article").css('width', height);
	 $("article").css('height', height);
	 $("article").css('left', (width-height)/2);
	 $("nav.left").css('width', (width-height)/2-50);
	 $("nav.right").css('width', (width-height)/2-50);
	 
     }
     
     function createPaletteBox() {
	 // Create palette box
	 hair_colors = ['#2b2518','#925e30','#e2b72d','#b5330a']
	 skin_tones = ["#7b4720", "#ad7039", "#daa159", "#f7c568", "#fbdd9b"]
	 shirt_colors = ["#d62e1f","#ef803c","#f2d75a","#81d957","#4389db","#75edf3","#be8aee","#ea7e7d"]
	 colors = shirt_colors.concat(hair_colors).concat(skin_tones)

	 for (var i = 0; i < colors.length; i++) {
	     d = document.getElementById("paletteBox").innerHTML
	     document.getElementById("paletteBox").innerHTML = d + '<input type="radio" name="color" value="' + colors[i
	     ] +'" id="' + i + '"/><label class="colorBox" for="' + i + '" style="background-color:' + colors[i] + '"></label>'
	 }
	 d = document.getElementById("paletteBox").innerHTML
	 //document.getElementById("paletteBox").innerHTML = d + '<input checked=true type="radio" name="color" value="black" id="defaultColor"/><label class="colorBox" for="defaultColor" style="background-color:black"></label>'
     }

     function coloring() {
	 // Set color
	 color = colors[0];
	 $('input:radio[name=color]').change(function () {
	     color = $(this).val();
	     console.log(color);
	 });

	 $("path, polygon, circle, rect").on('click touchstart',function(){
	     //console.log($(this).attr("id"))
	     if($(this).attr("id")==null) {
		 $(this).css({fill: color})
	     }
	 });
	 // Color on drag
	 var isDown = false;
	 $(document).bind( "mousedown touchstart", function(e){
	     isDown = true;
	 }).bind( "mouseup touchend", function(e){
	     isDown = false;    // When mouse goes up, set isDown to false
	 });
	 $("path, polygon, circle, rect").bind( "mouseover hover", function(e){
	     if(isDown) {
		 if($(this).attr("id")==null) {
		     $(this).css({fill: color})
		 }
	     }
	 });
     }

     function onDeviceReady() {
	 // Set size
	 setSize();
	 
	 // Create color pallete box
	 createPaletteBox();
	 
	 // Elements to inject
	 var mySVGsToInject = document.querySelectorAll('img.inject-me');
	 // Options
	 var injectorOptions = {
	     evalScripts: 'once',
	     pngFallback: 'assets/png',
	     each: function (svg) {
		 coloring();
		 // Callback after each SVG is injected
		 console.log('SVG injected: ' + svg.getAttribute('id'));
	     }
	 };
	 // Trigger the injection
	 SVGInjector(mySVGsToInject, injectorOptions, function (totalSVGsInjected) {
	     // Callback after all SVGs are injected
	     console.log('We injected ' + totalSVGsInjected + ' SVG(s)!');
	 });
     };
    </script>
</html>
